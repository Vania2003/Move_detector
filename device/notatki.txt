mosquitto_sub -h localhost -t 'iot/eldercare/room1/motion/health' -v
ssh pi@raspberrypi.local
‚Üí Login ‚Äî pi
‚Üí Has≈Ço ‚Äî raspberry
vcgencmd measure_temp
amni ikyo ulpj osas
sudo chown -R pi:pi /home/pi/DYPLOM/device/raspberry
sudo systemctl stop rules-engine notifier
sudo systemctl start rules-engine notifier

1) –ö–∞—Ä—Ç–∏–Ω–∞ —Ü–µ–ª–∏–∫–æ–º
–ó–∞–¥–∞—á–∞ —Å–∏—Å—Ç–µ–º—ã: –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –æ—Ç PIR-–¥–∞—Ç—á–∏–∫–æ–≤ (ESP8266) —á–µ—Ä–µ–∑ MQTT, –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –≤ SQLite, –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –≤—ã—è–≤–ª–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π (INACTIVITY, DWELL_CRITICAL –∏ —Ç.–ø.), —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞–ª–µ—Ä—Ç—ã –∏ —Ä–∞—Å—Å—ã–ª–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (email), –∞ —Ç–∞–∫–∂–µ –æ—Ç–¥–∞–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é/—Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–µ—Ä–µ–∑ HTTP API (Flask). –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –µ—Å—Ç—å —Å–∏–º—É–ª—è—Ç–æ—Ä –∏ —Å—Ü–µ–Ω–∞—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã.

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

ESP8266 (Arduino/PlatformIO) ‚Üí –ø—É–±–ª–∏–∫—É–µ—Ç MQTT-—Å–æ–æ–±—â–µ–Ω–∏—è (motion/state, motion/health).

Mosquitto (MQTT –±—Ä–æ–∫–µ—Ä) ‚Üí –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ —Ä–∞–∑–¥–∞—ë—Ç —Ç–æ–ø–∏–∫–∏.

MQTT‚ÜíSQLite –ª–æ–≥–≥–µ—Ä (mqtt_logger.py) ‚Üí –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Ç–æ–ø–∏–∫–∏, –ø–∏—à–µ—Ç:

¬´—Å—ã—Ä—ã–µ¬ª —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî messages_raw,

–¥–≤–∏–∂–µ–Ω–∏—è ‚Äî motion_events,

–ø—É–ª—å—Å—ã –∑–¥–æ—Ä–æ–≤—å—è ‚Äî heartbeats,

—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ/–∫–æ–º–Ω–∞—Ç—É ‚Äî devices/rooms.

–ü—Ä–∞–≤–∏–ª–∞ (rules_engine.py) ‚Üí –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —á–∏—Ç–∞–µ—Ç –ë–î –∏:

–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç alerts (INACTIVITY, DWELL_CRITICAL, NO_HEARTBEAT),

–æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä–æ–≥–∏ –∏–∑ rule_settings.

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (notifier.py) ‚Üí –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç alerts –∏ —à–ª—ë—Ç email —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ notifications_log.

HTTP API (app.py, Flask) ‚Üí —É–¥–æ–±–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π/–∞–ª–µ—Ä—Ç–æ–≤/–¥–µ–≤–∞–π—Å–æ–≤.

–°–∏–º—É–ª—è—Ç–æ—Ä –∏ —Ç–µ—Å—Ç—ã ‚Üí publish_sim.py (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π), run_tests.sh (–ø–∞–∫–µ—Ç —Ç–µ—Å—Ç–æ–≤).

–°–µ—Ä–≤–∏—Å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã ‚Üí –¥–µ–ø–ª–æ–π (push/pull), –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ SQL, –º–∏–≥—Ä–∞—Ü–∏–∏.

2) –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ Raspberry Pi

–ü–∞–ø–∫–∞: /home/pi/DYPLOM/device/raspberry

app.py                    # Flask API (–ø–æ—Ä—Ç 5000)
db_maintenance.sql        # —Å–ª—É–∂–µ–±–Ω—ã–µ SQL-–∑–∞–¥–∞—á–∏ (–æ—á–∏—Å—Ç–∫–∏/–∏–Ω–¥–µ–∫—Å—ã –∏ —Ç.–ø.)
mqtt_listener.py          # (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç)
mqtt_logger.py            # –æ—Å–Ω–æ–≤–Ω–æ–π MQTT‚ÜíSQLite –ª–æ–≥–≥–µ—Ä
rules_engine.py           # –¥–≤–∏–∂–æ–∫ –ø—Ä–∞–≤–∏–ª
notifier.py               # –æ—Ç–ø—Ä–∞–≤–∫–∞ email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ –∞–ª–µ—Ä—Ç–∞–º
publish_sim.py            # –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä MQTT-—Å–æ–±—ã—Ç–∏–π (—Å–∏–º—É–ª—è—Ç–æ—Ä)
run_tests.sh              # –ø–∞–∫–µ—Ç–Ω–∞—è –ø—Ä–æ–≥–æ–Ω–∫–∞ 10 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
schema.sql                # —Å—Ö–µ–º–∞ –ë–î –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ (DDL)
events.db                 # —Å–∞–º–∞ –±–∞–∑–∞ SQLite (+ WAL/SHM)
events.db-wal / .db-shm   # WAL/SHM –¥–ª—è SQLite
events_backup_*.db        # —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏


–°–µ—Ä–≤–∏—Å–Ω—ã–µ unit-—Ñ–∞–π–ª—ã (–≤ —Å–∏—Å—Ç–µ–º–µ):

/etc/systemd/system/mqtt-logger.service   # MQTT ‚Üí SQLite
/etc/systemd/system/rules-engine.service  # –î–≤–∏–∂–æ–∫ –ø—Ä–∞–≤–∏–ª
/etc/systemd/system/notifier.service      # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
# –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: override conf —Å Environment= –¥–ª—è SMTP

3) MQTT ‚Äî —Ç–æ–ø–∏–∫–∏ –∏ –ø–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞

–¢–æ–ø–∏–∫–∏ (ESP ‚Üí –±—Ä–æ–∫–µ—Ä):

iot/eldercare/<room>/motion/state

{"device":"esp8266_test","motion":true|false}


(–≤ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º ts –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏, ESP —à–ª—ë—Ç –±–µ–∑ ts ‚Äî –≤—Ä–µ–º—è –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç –±—Ä–æ–∫–µ—Ä/–ª–æ–≥–≥–µ—Ä).

iot/eldercare/<room>/motion/health

{"device":"esp8266_test","uptime_ms": 1234567}


–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ ESP –ø–æ—Å—ã–ª–∞–µ—Ç ¬´boot¬ª —Å IP (—Ä–µ—Ç–µ–π–Ω).

–£—á—ë—Ç –≤ –ë–î:

–≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ø–∞–¥–∞—é—Ç –≤ messages_raw;

–¥–≤–∏–∂–µ–Ω–∏—è ‚Äî –≤ motion_events (–±—É–ª–µ–≤–æ –∫–∞–∫ value=0/1);

–ø—É–ª—å—Å—ã ‚Äî –≤ heartbeats;

–ø–æ –ø–µ—Ä–≤—ã–º —Å–æ–±—ã—Ç–∏—è–º —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º device/room –≤ devices/rooms.

4) –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite, events.db)
–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

messages_raw

id INTEGER PK, ts_utc TEXT ISO8601, topic TEXT, payload TEXT


motion_events

id INTEGER PK,
ts_utc TEXT ISO8601,         -- –≤–∞–∂–Ω–æ: 'YYYY-MM-DDTHH:MM:SS'
device_id TEXT NOT NULL,
value INTEGER NOT NULL CHECK (value IN (0,1))
INDEX idx_motion_dev_ts(device_id, ts_utc)


heartbeats

id INTEGER PK,
ts_utc TEXT '%Y-%m-%d %H:%M:%S' –∏–ª–∏ ISO8601,
device_id TEXT NOT NULL,
uptime_ms INTEGER NULL


devices

device_id TEXT PK,
room TEXT NULL,              -- –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ room TEXT (–º–∞–ø–ø–∏–Ω–≥ –¥–µ–≤–∞–π—Å‚Üí–∫–æ–º–Ω–∞—Ç–∞)
... (–º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–ø. –ø–æ–ª—è)


rooms

id INTEGER PK,
name TEXT UNIQUE


alerts

id INTEGER PK,
ts_utc TEXT,                 -- –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è/–æ—Ç–∫—Ä—ã—Ç–∏—è –ø—Ä–∞–≤–∏–ª–∞
room TEXT,                   -- –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∏–º—è –∫–æ–º–Ω–∞—Ç—ã
device_id TEXT,              -- –∏–Ω–æ–≥–¥–∞ –≤–º–µ—Å—Ç–æ room –¥–ª—è NO_HEARTBEAT
type TEXT,                   -- "INACTIVITY", "DWELL_CRITICAL", "NO_HEARTBEAT", ...
severity TEXT,               -- "high" / "medium" ...
details TEXT,                -- –ø–æ—è—Å–Ω–µ–Ω–∏–µ (–º–∏–Ω—É—Ç—ã/—Å–µ–∫—É–Ω–¥—ã –∏ —Ç.–ø.)
status TEXT,                 -- 'open'|'closed'
created_at TEXT,             -- —à—Ç–∞–º–ø —Å–æ–∑–¥–∞–Ω–∏—è
closed_at TEXT NULL,         -- —à—Ç–∞–º–ø –∑–∞–∫—Ä—ã—Ç–∏—è
ack_at TEXT NULL, ack_by TEXT NULL,
notified_at TEXT NULL,       -- –∫–æ–≥–¥–∞ –≤–ø–µ—Ä–≤—ã–µ —É–≤–µ–¥–æ–º–∏–ª–∏
channels TEXT NULL,          -- "email,telegram" (–Ω–∞ –±—É–¥—É—â–µ–µ)
rule TEXT NULL,              -- —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π –∫–ª—é—á –ø—Ä–∞–≤–∏–ª–∞
params TEXT NULL             -- JSON —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—Ä–∞–≤–∏–ª–∞ (–Ω–∞ –±—É–¥—É—â–µ–µ)


rule_settings ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ—Ä–æ–≥–æ–≤ –ø—Ä–∞–≤–∏–ª (K/V)

id INTEGER PK, key TEXT UNIQUE, value TEXT
# —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:
inactive.threshold_day_min = 0.5
inactive.threshold_night_min = 1
night.window = 23:00-06:00
dwell.critical_rooms = Bathroom,Kitchen
dwell.bathroom_min = 0.3
dwell.kitchen_min = 0.5
dwell.gap_min = 2
pattern.window_days = 14
pattern.z_threshold = 2.5


notifications_log ‚Äî –∂—É—Ä–Ω–∞–ª –ø–æ–ø—ã—Ç–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

id INTEGER PK,
alert_id INTEGER,
channel TEXT,                -- 'email'
sent_at TEXT,
ok INTEGER,                  -- 1/0
err TEXT NULL


daily_stats ‚Äî –∑–∞–¥–µ–ª –ø–æ–¥ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ (—Å–µ–π—á–∞—Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏: —É –Ω–∞—Å –≤ –ë–î –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –æ–±–µ —Ñ–æ—Ä–º—ã (YYYY-MM-DDTHH:MM:SS –∏ YYYY-MM-DD HH:MM:SS). –í –∫–æ–¥–µ –ø—Ä–∞–≤–∏–ª –º—ã —É—á–ª–∏ —ç—Ç–æ —Å –ø–æ–º–æ—â—å—é parse_ts().

5) –°–ª—É–∂–±—ã (systemd)
mqtt-logger.service

–ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ MQTT-—Ç–æ–ø–∏–∫–∏ –∏ –ø–∏—à–µ—Ç –≤ –ë–î.

–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫, —Ä–µ—Å—Ç–∞—Ä—Ç –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏.

rules-engine.service

–ö–∞–∂–¥—ã–µ CHECK_INTERVAL —Å–µ–∫—É–Ω–¥ (—Å–µ–π—á–∞—Å 15) —á–∏—Ç–∞–µ—Ç –ë–î –∏:

INACTIVITY ‚Äî –Ω–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è –¥–æ–ª—å—à–µ –ø–æ—Ä–æ–≥–∞ (–¥–µ–Ω—å/–Ω–æ—á—å –∏–∑ rule_settings).

DWELL_CRITICAL ‚Äî –ø–æ–≤—ã—à–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫–æ–º–Ω–∞—Ç–∞—Ö –∑–∞ –æ–∫–Ω–æ.

NO_HEARTBEAT ‚Äî –Ω–µ—Ç –ø—É–ª—å—Å–∞ –¥–µ–≤–∞–π—Å–∞ > 30 –º–∏–Ω—É—Ç.

–û—Ç–∫—Ä—ã–≤–∞–µ—Ç/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ alerts (–±–µ–∑ –¥—É–±–ª–µ–π –ø–æ –æ—Ç–∫—Ä—ã—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é).

–£—á—ë—Ç day/night –ø–æ night.window.

–ü–∞—Ä—Å–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å ISO –∏ —Å –ø—Ä–æ–±–µ–ª–æ–º.

notifier.service

–ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É –∏—â–µ—Ç alerts.status='open' AND notified_at IS NULL –∏ –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å email.

–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ notifications_log, –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç alerts.notified_at –ø—Ä–∏ —É—Å–ø–µ—Ö–µ.

–ù–∞—Å—Ç—Ä–æ–µ–Ω–æ —á–µ—Ä–µ–∑ drop-in override.conf (Environment=SMTP_* / ALERT_EMAIL).

–î–ª—è Gmail –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è App Password (–∞ –Ω–µ –æ–±—ã—á–Ω—ã–π –ø–∞—Ä–æ–ª—å).

–ë—ã—Å—Ç—Ä–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
sudo systemctl stop notifier (–ø—Ä–∞–≤–∏–ª–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å).

6) HTTP API (Flask, app.py)

–°–µ—Ä–≤–∏—Å —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 5000 (–∏, —Å—É–¥—è –ø–æ –ª–æ–≥—É, —É–∂–µ –∑–∞–ø—É—â–µ–Ω –∫–∞–∫ —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å).
–ë—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

GET /
‚Üí {"status":"ok","message":"Eldercare API active"}

GET /api/messages?limit=N
‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å—ã—Ä—ã—Ö MQTT —Å–æ–æ–±—â–µ–Ω–∏–π: ts_utc, topic, payload.

GET /api/health/latest
‚Üí –ø–æ –∫–∞–∂–¥–æ–º—É device_id: last_hb –∏ –º–∞–∫—Å–∏–º—É–º uptime_ms.

GET /api/devices
–ó–∞–º–µ—á–∞–Ω–∏–µ: –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –¥–µ–ª–∞–ª LEFT JOIN rooms r ON r.id = d.room_id.
–ú—ã –¥–æ–±–∞–≤–∏–ª–∏ devices.room TEXT, –ø–æ—ç—Ç–æ–º—É –∫ –∑–∞–ø—Ä–æ—Å—É —Å—Ç–æ–∏—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è (—Å–º. –Ω–∏–∂–µ To-Do).

GET /api/alerts
‚Üí —Å–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤: id, ts_utc, room, device_id, type, severity, status, details.

–ü–æ–∑–∂–µ, –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞, –¥–æ–±–∞–≤–∏–º:

POST /api/alerts/:id/ack|close,

GET /api/rules / PUT /api/rules,

—Ñ–∏–ª—å—Ç—Ä—ã/–ø–∞–≥–∏–Ω–∞—Ü–∏—é –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∏ —Ç.–¥.

7) –°–∏–º—É–ª—è—Ü–∏—è –∏ —Ç–µ—Å—Ç—ã
publish_sim.py

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π TUI –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π –≤ MQTT:

—Ä–µ–∂–∏–º—ã: morning/day/night/bathroom_long/kitchen_cooking/random/manual,

–º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å room / device_id / duration,

–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–∞–≤–∏–ª –∏ API.

run_tests.sh

–ü–∞–∫–µ—Ç –∏–∑ 10 –∫–æ—Ä–æ—Ç–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:

—É—Ç—Ä–æ/–¥–µ–Ω—å/–Ω–æ—á—å, –¥–ª–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–±—ã–≤–∞–Ω–∏–µ –≤ –≤–∞–Ω–Ω–æ–π, –∫—É—Ö–Ω—è, —Ä—É—á–Ω–æ–π on/off, inactivity ‚Üí recovery, ¬´—Å–ª—É—á–∞–π–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å¬ª, —Ñ–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞,

–∫–∞–∂–¥—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø—É–±–ª–∏–∫—É–µ—Ç MQTT-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ publish_sim.py, –∂–¥—ë—Ç –∫—Ä–∞—Ç–∫–∏–µ –ø–∞—É–∑—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ë–î/–∞–ª–µ—Ä—Ç—ã,

–≤—ã–≤–æ–¥–∏—Ç –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º (–º—ã —É–∂–µ –≤–∏–¥–µ–ª–∏ ¬´‚úÖ INACTIVITY triggered ‚Ä¶¬ª, ¬´‚úÖ DWELL_CRITICAL ‚Ä¶¬ª –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ –∞–ª–µ—Ä—Ç–∞ ¬´recovery¬ª).

8) ESP8266 (Arduino/PlatformIO)

–ì–ª–∞–≤–Ω–æ–µ:

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Wi-Fi (wifiEnsure).

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MQTT (mqttEnsure) —Å —É—á—ë—Ç–æ–º –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è.

PIR-–æ–±—Ä–∞–±–æ—Ç–∫–∞:

—Ç—ë–ø–ª—ã–π —Å—Ç–∞—Ä—Ç PIR_WARMUP_MS (–∏–≥–Ω–æ—Ä –ø–µ—Ä–≤—ã—Ö 30 —Å–µ–∫),

–∞–Ω—Ç–∏–¥—Ä–µ–±–µ–∑–≥ EDGE_DEBOUNCE,

–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π LOW NEED_LOW_MS –ø–µ—Ä–µ–¥ –Ω–æ–≤–æ–π –ø–æ—Å—ã–ª–∫–æ–π HIGH,

–ø—É–±–ª–∏–∫–∞—Ü–∏—è motion=true/false –≤ TOPIC_STATE, –º–æ—Ä–≥–∞–Ω–∏–µ LED.

–ü—É–ª—å—Å –∑–¥–æ—Ä–æ–≤—å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ (TOPIC_HEALTH —Å uptime_ms).

–í include/config.h –∑–∞–¥–∞—ë–º:

WIFI_SSID / WIFI_PASS
MQTT_HOST / MQTT_PORT / MQTT_USER / MQTT_PASS
DEVICE_ID
TOPIC_HEALTH / TOPIC_STATE (–≤–∫–ª—é—á–∞—è ¬´room1¬ª)


pir.h/.cpp ‚Äî –º–æ–¥—É–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–∞—Ç—á–∏–∫–∞ (–¥–µ–±–∞—É–Ω—Å/–ø–æ—Ä–æ–≥).

–ú—ã —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏: –ø—Ä–∏ –º–∞—Ö–µ —Ä—É–∫–æ–π –≤ API –≤–∏–¥–∏–º —á–µ—Ä–µ–¥—É motion:true/false –∏ —Ä–∞—Å—Ç—É—â–∏–π uptime_ms. –ó–Ω–∞—á–∏—Ç —Å–≤—è–∑–∫–∞ ESP ‚Üí MQTT ‚Üí –ª–æ–≥–≥–µ—Ä ‚Üí –ë–î ‚Üí API —Ä–∞–±–æ—á–∞—è.

9) –ß—Ç–æ —É–∂–µ –¥–æ–∫–∞–∑–∞–Ω–æ —Ç–µ—Å—Ç–∞–º–∏ –∏ —Ä—É–∫–∞–º–∏

MQTT —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ —Ñ–æ—Ä–º–∞—Ç payload —É—Å—Ç–æ–π—á–∏–≤—ã.

–õ–æ–≥–≥–µ—Ä –ø–∏—à–µ—Ç –≤ messages_raw, motion_events, heartbeats.

–ü—Ä–∞–≤–∏–ª–∞ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è, –æ—Ç–∫—Ä—ã–≤–∞—é—Ç/–∑–∞–∫—Ä—ã–≤–∞—é—Ç INACTIVITY, –¥–µ—Ç–µ–∫—Ç—è—Ç DWELL_CRITICAL.

Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ —É—Ö–æ–¥—è—Ç (–≤–∏–¥–Ω–æ –≤ –ø–æ—á—Ç–µ –∏ –≤ notifications_log, –ø—Ä–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è alerts.notified_at).

–ë—ã—Å—Ç—Ä—ã–µ ¬´–∂–∏–≤—ã–µ¬ª —Ç–µ—Å—Ç—ã PIR –Ω–∞ —Å—Ç–æ–ª–µ ‚Üí API –æ—Ç—Ä–∞–∂–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è.

10) –ò–∑–≤–µ—Å—Ç–Ω—ã–µ —Ç–æ–Ω–∫–æ—Å—Ç–∏/—Ä–µ—à–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º—ã —É–∂–µ –≤–Ω–µ–¥—Ä–∏–ª–∏

–§–æ—Ä–º–∞—Ç—ã –≤—Ä–µ–º–µ–Ω–∏: –≤ motion_events.ts_utc –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º ISO8601 (‚Ä¶T‚Ä¶). –í –ø—Ä–∞–≤–∏–ª–µ ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ –æ–±–µ–∏—Ö —Ñ–æ—Ä–º (ISO / —Å –ø—Ä–æ–±–µ–ª–æ–º).

motion_events –±–µ–∑ room: –º—ã –Ω–µ –¥–æ–±–∞–≤–ª—è–ª–∏ room –≤ —ç—Ç—É —Ç–∞–±–ª–∏—Ü—É, –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö –¥–µ–ª–∞–µ–º JOIN devices ON m.device_id = d.device_id –∏ —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ d.room. –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è.

–ú–∏–≥—Ä–∞—Ü–∏–∏: schema.sql —Ä–∞–Ω—å—à–µ –ø–∞–¥–∞–ª –Ω–∞ DEFAULT –¥–ª—è ALTER TABLE ... ADD COLUMN. –ú—ã –ø–æ—á–∏–Ω–∏–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç—ã–º–∏ ADD COLUMN + –æ—Ç–¥–µ–ª—å–Ω—ã–º UPDATE.

–ü—Ä–∞–≤–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ —Å Windows: –±—ã–ª–∏ –æ—à–∏–±–∫–∏ scp: Permission denied –∏–∑-–∑–∞ –∫–æ—Ä–Ω–µ–≤—ã—Ö –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∏/–∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ñ–∞–π–ª–æ–≤. –†–µ—à–µ–Ω–∏–µ ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é –ø–∞–ø–∫—É –∏ sudo mv –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å rsync —Å --rsync-path="sudo rsync". (–ú—ã –¥–∞–≤–∞–ª–∏ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã push/pull.)

11) –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å/To-Do –ø–µ—Ä–µ–¥ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ (–∫–æ—Ä–æ—Ç–∫–æ):

–ü–æ–¥—á–∏—Å—Ç–∏—Ç—å –≤–∏—Å—è—â–∏–µ ¬´NO_HEARTBEAT¬ª –∏–∑ —Ä–∞–Ω–Ω–∏—Ö —Ç–µ—Å—Ç–æ–≤ (—Å—Ç–∞—Ä—ã–µ –º—É–ª—è–∂–∏):

DELETE FROM alerts WHERE type='NO_HEARTBEAT' AND details='no heartbeat ever';


/api/devices ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –ø–æ–¥ devices.room TEXT. –ü—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç:

SELECT d.device_id,
       d.room AS room,
       (SELECT MAX(ts_utc) FROM heartbeats h WHERE h.device_id=d.device_id) AS last_hb
FROM devices d
ORDER BY last_hb DESC;


–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞–º–∏ (–Ω–∞ –ø–æ—Ç–æ–º —Ñ—Ä–æ–Ω—Ç—É):

POST /api/alerts/<id>/ack (–ø–æ–º–µ—á–∞—Ç—å ¬´–≤ —Ä–∞–±–æ—Ç–µ¬ª: ack_at, ack_by),

POST /api/alerts/<id>/close (–∑–∞–∫—Ä—ã–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é),

GET /api/alerts?status=open|closed&room=...&type=...&since=....

–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (–º–∏–Ω–∏–º—É–º):

Mosquitto: –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/–ø–∞—Ä–æ–ª—å, ACL –ø–æ —Ç–æ–ø–∏–∫–∞–º.

Flask API: —Ö–æ—Ç—è –±—ã –±–∞–∑–æ–≤–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è/—Ç–æ–∫–µ–Ω.

–ë—ç–∫–∞–ø—ã –∏ —Ä–æ—Ç–∞—Ü–∏—è:

–Ω–æ—á–Ω–æ–π sqlite3 VACUUM;/—Ä–æ—Ç–∞—Ü–∏—è messages_raw,

cron –¥–ª—è events_backup_%F_%H-%M.db + —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö.

–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ NIGHT_ACTIVITY –∏ PATTERN_SHIFT (—Å–∫–µ–ª–µ—Ç—ã —É –Ω–∞—Å –≥–æ—Ç–æ–≤—ã: –µ—Å—Ç—å night.window, pattern.window_days, pattern.z_threshold ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á—ë—Ç—ã).

–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏: —Å—Ç—Ä–æ–≥–æ ISO8601 (–∏ —ç—Ç–æ –∂–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ API).

–î–æ–±–∞–≤–∏—Ç—å systemd unit –¥–ª—è app.py (—Å–µ–π—á–∞—Å API –∑–∞–ø—É—â–µ–Ω, –Ω–æ –±–µ–∑ unit ‚Äî –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –µ–¥–∏–Ω–æ–º—É —Å—Ç–∏–ª—é).

–ù–µ–±–æ–ª—å—à–æ–π CLI (iot start|stop|status) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è rules-engine/notifier.

12) –ú–∏–Ω–∏-¬´–ø–∞–º—è—Ç–∫–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏¬ª

–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É:
sudo systemctl stop notifier

–ü–æ–ª–Ω–æ—Å—Ç—å—é ¬´—É—Å—ã–ø–∏—Ç—å¬ª –æ–±—Ä–∞–±–æ—Ç–∫—É:
sudo systemctl stop rules-engine notifier

–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë:
sudo systemctl start mqtt-logger rules-engine notifier

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞—Ç—á–∏–∫ –≤–∂–∏–≤—É—é (1-–º–∏–Ω—É—Ç–Ω—ã–π —Ç–µ—Å—Ç):

–£–±–µ–¥–∏—Å—å, —á—Ç–æ —Å–ª—É–∂–±—ã –≤–∫–ª—é—á–µ–Ω—ã:
sudo systemctl start mqtt-logger rules-engine

–ü–æ–º–∞—à–∏ —Ä—É–∫–æ–π –ø–µ—Ä–µ–¥ PIR ‚Üí –∑–∞—Ç–µ–º:
curl http://localhost:5000/api/messages?limit=5
(—É–≤–∏–¥–∏—à—å motion:true/false –∏ uptime_ms).

SELECT * FROM motion_events ORDER BY id DESC LIMIT 5; ‚Äî —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∑–∞–ø–∏—Å—å –≤ –ë–î –µ—Å—Ç—å.

–ï—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω notifier ‚Äî –º–æ–∂–µ—à—å –ø–æ–ª—É—á–∏—Ç—å –ø–∏—Å—å–º–æ (–ª—É—á—à–µ –¥–µ—Ä–∂–∞—Ç—å –µ–≥–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ).

13) –ì–¥–µ –º—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞

(0) –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è payload –Ω–∞ ESP ‚Äî ‚úÖ (—Ñ–æ—Ä–º–∞—Ç JSON —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω, —Å—Ç–∞–±–∏–ª—å–Ω—ã–π).
(1) –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î + rule_settings –∏ notifications_log ‚Äî ‚úÖ (–æ–±–∞ –µ—Å—Ç—å, –º–∏–≥—Ä–∞—Ü–∏–∏ –æ—Ç–ª–∞–∂–µ–Ω—ã).
(2) –ü—Ä–∞–≤–∏–ª–∞: INACTIVITY ‚Äî ‚úÖ; DWELL_CRITICAL ‚Äî ‚úÖ; NIGHT_ACTIVITY/PATTERN_SHIFT ‚Äî ‚öôÔ∏è –≥–æ—Ç–æ–≤—ã –±–∞–∑—ã, –æ—Å—Ç–∞–ª–æ—Å—å –¥–æ–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏–∫—É.
(3) –°–µ—Ä–≤–∏—Å notifier.py + systemd ‚Äî ‚úÖ (email –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è).
(4) –ú–∏–Ω–∏-—Å–∏–º—É–ª—è—Ç–æ—Ä –ø—Ä–æ—Ñ–∏–ª–µ–π ‚Äî ‚úÖ (publish_sim.py) + –ø–∞–∫–µ—Ç —Ç–µ—Å—Ç–æ–≤ run_tests.sh.
(5) –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ API ‚Äî üü° –±–∞–∑–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –µ—Å—Ç—å; ack/close/filters ‚Äî –≤ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ.
(6) –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å MQTT –∏ API ‚Äî üü° –±–∞–∑–æ–≤—ã–π –ª–æ–≥–∏–Ω –≤ MQTT –µ—Å—Ç—å; ACL/—Ç–æ–∫–µ–Ω –∫ API ‚Äî next.
(7) –õ–æ–≥–∏ –∏ –±—ç–∫–∞–ø—ã ‚Äî üü° —á–∞—Å—Ç–∏—á–Ω–æ (journald + —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –≤—Ä—É—á–Ω—É—é; –æ—Ñ–æ—Ä–º–∏—Ç—å cron).
(8) UI-–º–∏–Ω–∏–º—É–º (React) ‚Äî ‚è≠ –∫–∞–∫ —Ä–∞–∑ —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫.
(9) –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚Äî üü° (–¥–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç ‚Äî –æ—Å–Ω–æ–≤–∞, –Ω–∞–¥–æ –ø–æ–ª–æ–∂–∏—Ç—å –≤ README.md).
(10) –ò—Å–ø—ã—Ç–∞–Ω–∏—è –∏ –æ—Ç—á—ë—Ç ‚Äî üü° –∏–¥—ë—Ç: —É –Ω–∞—Å –µ—Å—Ç—å —Å–∏–º—É–ª—è—Ç–æ—Ä + —Ä–µ–∞–ª—å–Ω—ã–π –¥–∞—Ç—á–∏–∫, –æ—Å—Ç–∞–ª–æ—Å—å —Å–æ–±—Ä–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

14) –ß—Ç–æ —è –ø—Ä–µ–¥–ª–∞–≥–∞—é —Å–¥–µ–ª–∞—Ç—å –ø—Ä—è–º–æ –ø–µ—Ä–µ–¥ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

–ú–∞–ª–µ–Ω—å–∫–∏–π PR –≤ app.py –¥–ª—è /api/devices (—Å–º. –ø. 11.2).

–î–æ–±–∞–≤–∏—Ç—å POST /api/alerts/<id>/ack|close (—Ñ—Ä–æ–Ω—Ç—É –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è —ç–∫—à–µ–Ω—ã).

–°–Ω—è—Ç—å ¬´–≤–∏—Å—è—â–∏–µ¬ª —Ç–µ—Å—Ç–æ–≤—ã–µ NO_HEARTBEAT.

–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å README.md: –∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞, —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, —Å—Ö–µ–º–∞ –ë–î.

–í–∫–ª—é—á–∏—Ç—å notifier —Ç–æ–ª—å–∫–æ –Ω–∞ –¥–µ–º–æ ‚Äî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–µ—Ä–∂–∞—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.

–û—á–∏—Å—Ç–∏–ª–∏ —Å—Ç–∞—Ä—ã–π —à—É–º ¬´NO_HEARTBEAT¬ª
–°–¥–µ–ª–∞–ª–∏ –∞–∫–∫—É—Ä–∞—Ç–Ω—É—é —á–∏—Å—Ç–∫—É —á–µ—Ä–µ–∑ WAL-—á–µ–∫–ø–æ–∏–Ω—Ç –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, —á—Ç–æ–±—ã –Ω–µ –ª–æ–≤–∏—Ç—å database is locked. –ë–æ–ª—å—à–µ ¬´–≤–µ—á–Ω—ã—Ö¬ª NO_HEARTBEAT –æ—Ç —Ä–∞–Ω–Ω–∏—Ö —Ç–µ—Å—Ç–æ–≤ –Ω–µ—Ç.

–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ SQLite (—Å–∫—Ä–∏–ø—Ç + cron)

–°–æ–∑–¥–∞–Ω /usr/local/bin/eldercare_backup.sh —Å PRAGMA wal_checkpoint(FULL) –∏ —Ç–∞–π–º–∞—É—Ç–æ–º –Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.

–ü—Ä–æ–≥–æ–Ω –≤—Ä—É—á–Ω—É—é –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ ‚Äî –ø–æ–ª—É—á–∏–ª–∏ —Å–≤–µ–∂–∏–µ events_backup_YYYY-MM-DD_HH-MM.db.

–í crontab –¥–æ–±–∞–≤–ª–µ–Ω—ã:

03:30 ‚Äî –±—ç–∫–∞–ø –ë–î —Å–∫—Ä–∏–ø—Ç–æ–º.

04:00 ‚Äî db_maintenance.sql (–∏–Ω—Ç–µ–≥—Ä–∏—Ç–µ—Ç/–∏–Ω–¥–µ–∫—Å—ã/—á–∏—Å—Ç–∫–∏).

–ó–∞—â–∏—Ç–∏–ª–∏ API —Ç–æ–∫–µ–Ω–æ–º (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)

–î–ª—è –≤—Å–µ—Ö /api/* –≤–Ω–µ–¥—Ä–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Authorization: Bearer secret123.

–ë–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–¥–∞—ë—Ç 401 Unauthorized (–≤–∏–¥–Ω–æ –ø–æ /api/messages –∏ /api/devices).

–° —Ç–æ–∫–µ–Ω–æ–º ‚Äî –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø—Ä–æ–≤–µ—Ä—è–ª–∏ –Ω–∞ /api/alerts).

–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω jq –¥–ª—è —É–¥–æ–±–Ω—ã—Ö CLI-–ø–∞–π–ø–ª–∞–π–Ω–æ–≤

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å/–∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–∞—á–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏.

–ö–æ–ª–æ–Ω–∫–∞ devices.room –∏ –ø—Ä–∏–≤—è–∑–∫–∞ –∫–æ–º–Ω–∞—Ç

–î–æ–±–∞–≤–∏–ª–∏ ALTER TABLE devices ADD COLUMN room TEXT;

–ó–∞–ø–æ–ª–Ω–∏–ª–∏ –º–∞–ø–ø–∏–Ω–≥ –¥–µ–≤–∞–π—Å‚Üí–∫–æ–º–Ω–∞—Ç–∞.

–õ–æ–≥–∏–∫—É –ø—Ä–∞–≤–∏–ª –ø–µ—Ä–µ–≤–µ–ª–∏ –Ω–∞ JOIN –ø–æ devices (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ; motion_events –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –∫–æ–ª–æ–Ω–∫–∏ room).

Rules Engine ‚Äî —É—Å—Ç–æ–π—á–∏–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –ø–∞—Ä—Å–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ (parse_ts) ‚Äî –ø–æ–Ω–∏–º–∞–µ—Ç –∏ YYYY-MM-DDTHH:MM:SS, –∏ —Å –ø—Ä–æ–±–µ–ª–æ–º.

–ü–æ–ª—É—á–µ–Ω–∏–µ ¬´–ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è¬ª —Ç–µ–ø–µ—Ä—å —á–µ—Ä–µ–∑ JOIN motion_events‚Üîdevices –ø–æ device_id.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–ª–æ–Ω–∫–∞–º (room/motion) –∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ñ–æ—Ä–º–∞—Ç—É –≤—Ä–µ–º–µ–Ω–∏.

–ü—Ä–æ–≤–µ—Ä–∫–∞ ¬´–≤–∂–∏–≤—É—é¬ª –Ω–∞ PIR/ESP

–£–±–µ–¥–∏–ª–∏—Å—å, —á—Ç–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ motion true/false –∏ health uptime_ms –¥–æ—Ö–æ–¥—è—Ç –¥–æ messages_raw –∏ –≤–∏–¥–Ω—ã —á–µ—Ä–µ–∑ API.

–í–∫–ª—é—á—ë–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Å–æ–∑–¥–∞—é—Ç/–∑–∞–∫—Ä—ã–≤–∞—é—Ç –∞–ª–µ—Ä—Ç—ã –ø–æ –∂–∏–≤—ã–º –¥–∞–Ω–Ω—ã–º.

–ì–∞—à–µ–Ω–∏–µ –ø–æ—á—Ç–æ–≤–æ–≥–æ —Å–ø–∞–º–∞ –Ω–∞ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

notifier –æ—Å—Ç–∞–≤–ª—è–µ–º –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º, —á—Ç–æ–±—ã —Ñ—Ä–æ–Ω—Ç –Ω–µ ¬´–∑–∞—Å—ã–ø–∞–ª–æ¬ª –ø–∏—Å—å–º–∞–º–∏. –í–∫–ª—é—á–∏–º —Ç–æ–ª—å–∫–æ –Ω–∞ –¥–µ–º–æ.

API /devices ‚Äî –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –Ω–∞ –ø—Ä–∞–≤–∫—É

–ú—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∏, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –Ω–∞–¥–æ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ devices.room –∏ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–∞ –ø–æ heartbeats. (–ì–æ—Ç–æ–≤—ã –≤–Ω–µ—Å—Ç–∏ —Å—Ä–∞–∑—É, –∫–æ–≥–¥–∞ —Å–∫–∞–∂–µ—à—å: —ç—Ç–æ 3‚Äì4 —Å—Ç—Ä–æ–∫–∏ SQL.)

–ò–¥–µ—è –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ ¬´—É–º–Ω–æ–≥–æ –ø—Ä–∏—Å–º–æ—Ç—Ä–∞¬ª –¥–ª—è –∫–≤–∞—Ä—Ç–∏—Ä—ã –ø–æ–∂–∏–ª–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞:

–Ω–µ–¥–æ—Ä–æ–≥–∏–µ PIR-–¥–∞—Ç—á–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏—è (ESP8266) ‚Üí –ø—É–±–ª–∏–∫—É—é—Ç —Å–æ–±—ã—Ç–∏—è –≤ MQTT (Mosquitto);

Raspberry Pi –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å—ë –≤ SQLite, –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≥–æ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞ (rules_engine) ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç alerts (INACTIVITY, DWELL_CRITICAL, NO_HEARTBEAT);

Flask HTTP API –æ—Ç–¥–∞—ë—Ç –∏—Å—Ç–æ—Ä–∏—é/—Å–æ—Å—Ç–æ—è–Ω–∏–µ;

–í–µ–±-–ø–∞–Ω–µ–ª—å (React) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –¥–∞—ë—Ç —Ñ–∏–ª—å—Ç—Ä—ã/—ç–∫—Å–ø–æ—Ä—Ç/–∫–Ω–æ–ø–∫–∏ ¬´Ack/Close¬ª, –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∞–≤–∏–ª.

–°–∫–≤–æ–∑–Ω–æ–π workflow (end-to-end)

–î–≤–∏–∂–µ–Ω–∏–µ: PIR –ª–æ–≤–∏—Ç –¥–≤–∏–∂–µ–Ω–∏–µ ‚Üí ESP8266 —à–ª—ë—Ç MQTT (iot/eldercare/<room>/motion/state —Å motion:true/false).

–ü—É–ª—å—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: ESP —à–ª—ë—Ç health/heartbeat (‚Ä¶/motion/health, uptime_ms –∏ device id).

MQTT-–ª–æ–≥–≥–µ—Ä (–Ω–∞ Pi) –ø–∏—à–µ—Ç –≤ SQLite:
messages_raw, motion_events, heartbeats, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç devices/rooms.

Rules Engine —Ä–∞–∑ –≤ N —Å–µ–∫—É–Ω–¥ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –ë–î ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç alerts:

INACTIVITY ‚Äî –Ω–µ—Ç –¥–≤–∏–∂–µ–Ω–∏—è —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ (–¥–µ–Ω—å/–Ω–æ—á—å ‚Äî —Ä–∞–∑–Ω—ã–µ –ø–æ—Ä–æ–≥–∏);

DWELL_CRITICAL ‚Äî –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –¥–ª–∏–Ω–Ω–æ–µ –ø—Ä–µ–±—ã–≤–∞–Ω–∏–µ –≤ ¬´–∫—Ä–∏—Ç–∏—á–Ω–æ–π¬ª –∫–æ–º–Ω–∞—Ç–µ (–Ω–∞–ø—Ä. –≤–∞–Ω–Ω–∞—è);

NO_HEARTBEAT ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–ª—á–∏—Ç.

(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) Notifier —Ä–∞—Å—Å—ã–ª–∞–µ—Ç email –ø—Ä–∏ –∫—Ä–∏—Ç–∏–∫–µ.

–í–µ–±-–ø–∞–Ω–µ–ª—å:

History ‚Äî —Å—ã—Ä—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è/–¥–≤–∏–∂–µ–Ω–∏—è/heartbeat, —Ñ–∏–ª—å—Ç—Ä—ã, CSV;

Devices ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ + –∏—Ö –ø–æ—Å–ª–µ–¥–Ω–∏–π heartbeat (UP/DOWN);

Alerts ‚Äî —Å–ø–∏—Å–æ–∫, —Ñ–∏–ª—å—Ç—Ä—ã, Ack/Close, Drawer —Å –¥–µ—Ç–∞–ª—è–º–∏, CSV, bulk-close –¥–ª—è NO_HEARTBEAT;

Settings ‚Äî –ø–æ—Ä–æ–≥–∏ –ø—Ä–∞–≤–∏–ª (—á—Ç–µ–Ω–∏–µ/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ).

–ß—Ç–æ —É–∂–µ ¬´–∂–∏–≤–æ–µ¬ª, –∞ —á—Ç–æ –µ—â—ë –º–æ–∫/–∑–∞–≥–ª—É—à–∫–∞
–°—Ç—Ä–∞–Ω–∏—Ü–∞/–±–ª–æ–∫	–ò—Å—Ç–æ—á–Ω–∏–∫	–°—Ç–∞—Ç—É—Å
Alerts (—Ç–∞–±–ª–∏—Ü–∞, —Ñ–∏–ª—å—Ç—Ä—ã, Ack/Close, Drawer, CSV, Live-polling)	/api/alerts, POST /api/alerts/{id}/ack, POST /api/alerts/{id}/close, POST /api/alerts/close-bulk?‚Ä¶	–†–ï–ê–õ–¨–ù–û–ï. –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ–≤–µ—Ä—Ö —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤ –∏–∑ –ë–î/–ø—Ä–∞–≤–∏–ª.
History ‚Üí –≤–∫–ª–∞–¥–∫–∞ Raw MQTT	/api/messages?limit=‚Ä¶	–†–ï–ê–õ–¨–ù–û–ï. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Å—ã—Ä—ã–µ MQTT-—Å–æ–æ–±—â–µ–Ω–∏—è.
History ‚Üí Motion events	/api/motion_events?limit=‚Ä¶	–†–ï–ê–õ–¨–ù–û–ï (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ª–æ–≥–≥–µ—Ä–∞).
History ‚Üí Heartbeats	/api/heartbeats?limit=‚Ä¶	–†–ï–ê–õ–¨–ù–û–ï.
Devices (—Ç–∞–±–ª–∏—Ü–∞ + UP/DOWN –ø–æ 30 –º–∏–Ω)	/api/devices (+ –ª–æ–∫–∞–ª—å–Ω–æ isUp, timeAgo)	–†–ï–ê–õ–¨–ù–û–ï ‚Äî —Å—Ç—Ä–æ–∏—Ç—Å—è –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö heartbeat.
Settings (Rule settings)	GET/PUT /api/rule-settings	–†–ï–ê–õ–¨–ù–û–ï ‚Äî —á–∏—Ç–∞–µ—Ç/—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–µ –ø–æ—Ä–æ–≥–∏ –ø—Ä–∞–≤–∏–ª.
Dashboard ‚Üí KPI: Open alerts, Devices	/api/alerts?status=open, /api/devices	–†–ï–ê–õ–¨–ù–û–ï.
Dashboard ‚Üí Latest MQTT table	/api/messages?limit=10	–†–ï–ê–õ–¨–ù–û–ï.
Dashboard ‚Üí –º–∏–Ω–∏-–≥—Ä–∞—Ñ ‚ÄúActivity‚Äù	–ª–æ–∫–∞–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤	–ú–û–ö (–≤–∏–∑—É–∞–ª—å–Ω—ã–π –∑–∞–ø–æ–ª–Ω–∏—Ç–µ–ª—å; –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–æ —Ä–µ–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏).
Rooms map (SVG-–∫–∞—Ä—Ç–æ—á–∫–∏ –∫–æ–º–Ω–∞—Ç)	–ª–æ–∫–∞–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤ ROOMS	–ú–û–ö (–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è/UX-—Å–∫–µ–ª–µ—Ç; –∫–ª–∏–∫–∏/hover —Ä–∞–±–æ—Ç–∞—é—Ç, –Ω–æ –¥–∞–Ω–Ω—ã–µ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã).

–ò—Ç–æ–≥: ¬´–º—è—Å–æ¬ª —É–∂–µ —Ä–µ–∞–ª—å–Ω–æ–µ ‚Äî –∞–ª–µ—Ä—Ç—ã / –∏—Å—Ç–æ—Ä–∏—è / —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ / –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –ó–∞–≥–ª—É—à–∫–∞–º–∏ –æ—Å—Ç–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ 2 –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞: –º–∏–Ω–∏-–≥—Ä–∞—Ñ –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ –∏ –∫–∞—Ä—Ç–∞ –∫–æ–º–Ω–∞—Ç.

–¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–û–ø–µ—Ä–∞—Ç–æ—Ä/—Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫:

–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Alerts, –≤–∏–¥–∏—Ç INACTIVITY / DWELL / NO_HEARTBEAT, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç, —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç, Ack –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏, Close –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏, –≤ Drawer ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∏ —Å—ã—Ä–æ–µ JSON.

–ø—Ä–∏ –≤—Å–ø–ª–µ—Å–∫–µ —Ñ–∞–ª—å—à-–ø–æ–∑–∏—Ç–∏–≤–æ–≤ –ø–æ ¬´—Å–µ—Ä–¥—Ü–µ–±–∏–µ–Ω–∏—é¬ª ‚Äî Bulk close NO_HEARTBEAT (–∫–Ω–æ–ø–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–∏–¥–∏–º–æ–π/–∞–∫—Ü–µ–Ω—Ç–Ω–æ–π —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —É–º–µ—Å—Ç–Ω–æ ‚Äî –º—ã —ç—Ç–æ —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏).

–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:

–∑–∞—Ö–æ–¥–∏—Ç –≤ History, —Å–º–æ—Ç—Ä–∏—Ç –ø–æ—Ç–æ–∫ Raw/Motion/Heartbeats, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç CSV.

–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤:

Devices ‚Äî –∫—Ç–æ ¬´–∂–∏–≤–æ–π¬ª, –∫–æ–≥–¥–∞ –±—ã–ª –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø—É–ª—å—Å, –∫–∞–∫–∞—è –∫–æ–º–Ω–∞—Ç–∞.

–ê–¥–º–∏–Ω/–∏–Ω–∂–µ–Ω–µ—Ä:

–ø—Ä–∞–≤–∏—Ç –ø–æ—Ä–æ–≥–∏ –≤ Settings (–¥–µ–Ω—å/–Ω–æ—á—å, –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã, –æ–∫–Ω–∞ –∞–Ω–∞–ª–∏–∑–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏ —Ç. –ø.).

–ß—Ç–æ –µ—â—ë –Ω–∞–¥–æ –¥–æ–ø–∏–ª–∏—Ç—å (–ø–æ —Å–ø–∏—Å–∫—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤)

Rooms map (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

–ø–æ–¥–≥—Ä—É–∑–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ä–∞–∑–º–µ—Ç–∫—É –∫–æ–º–Ω–∞—Ç (–∏–∑ /api/devices/rooms) –∏ —Å—á—ë—Ç—á–∏–∫–∏ –¥–≤–∏–∂–µ–Ω–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ X –º–∏–Ω—É—Ç;

–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: ¬´—Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞¬ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ motion_events.

–ú–∏–Ω–∏-–≥—Ä–∞—Ñ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ Dashboard

–ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∏–∑ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ /api/motion_events (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –ø–æ —á–∞—Å–∞–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—É—Ç–∫–∏).

–£–ª—É—á—à–µ–Ω–∏—è —É–¥–æ–±—Å—Ç–≤–∞ (UX)

–±—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ Alerts (¬´–∑–∞ —á–∞—Å¬ª, ¬´—Ç–æ–ª—å–∫–æ INACTIVITY¬ª, ¬´—Ç–æ–ª—å–∫–æ –æ—Ç–∫—Ä—ã—Ç—ã–µ¬ª);

—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ URL/query (deep-linking).

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–µ—Å–ª–∏ email-–Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É–∂–µ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ Pi ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –≤ Settings –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞ –∏ —Ç–µ—Å—Ç–æ–≤—É—é –∫–Ω–æ–ø–∫—É ¬´send test¬ª.